<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>BOTC Notes</title>
	<link rel="stylesheet" href="./style/notes.css" />
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css">
	<script src="./js/NoteManager.js"></script>
	<script defer src="./js/notes.js"></script>
	<script defer src="./js/solver.js"></script>
</head>

<body>
	<!--nav id="menu" class="w3-bar w3-border w3-green">
		<div class="w3-flex" style="justify-content:space-around">
			<div style="max-width: 50%">
				<label for="playerCountInput">Player count: <span id="playerCountSpan">10</span> </label>
				<input id="playerCountInput" type="range" min="5" max="20" step="1" value="10" onchange="setPlayerCount(this)"/>
			</div>
			<div style="max-width: 50%">
				<button onclick="showSetupWindow()">Setup</button>
			</div>
	    </div>
	    <div class="w3-flex" style="justify-content:space-around; margin-top: 5px;">
	    <button id="showHideRolesBtn" onclick="showHidePlayerRoles()" class="w3-yellow">Hide Roles</button>
	    <button disabled id="clearSavedBtn" onclick="clearSavedData()" class="w3-red">Clear Data</button>
	    <button disabled id="loadSavedBtn" onclick="loadSavedData()" class="w3-green">Load Data</button>
	    </div>
	</nav-->
	<div id="settings"><button onclick="showHideSettings()">&#9881;</button></div>
	<div id="central">
		<h4>Central Info</h4>
		<p>This is the central info here and some more text here...</p>
	</div>
	<div id="solverOutput"></div>
	<div id="main">
	    <!-- Default to 5 players -->
	    <div class="player" id="player1">
	        <div class="role blank" onclick="changeRole(this)">
	            <i class="roleAdd">+</i>
	        </div>
	        <input type="text" value="Name" />
	    </div>
	</div>
	<div id="addRoleWindow">
		<!-- Fill based on script -->
	</div>
	<div id="setupWindow">
		<h3>Setup Window <button onclick="hideSetupWindow()">X</button></h3>

		<h4>Players</h4>
		<!--label for="playerCountInput">Player count: <span id="playerCountSpan">10</span></label>
		<input id="playerCountInput" type="range" min="5" max="20" step="1" value="10" onchange="setPlayerCount(this)"/-->
		
		<h4 for="scriptInput">Script: </h4>
	    <select id="scriptInput" onchange="setScript(this)">
	    	<option value="tb">Trouble Brewing</option>
	    	<option value="bmr">Bad Moon Rising</option>
	    	<option value="snv">Sects and Violets</option>
	    	<option value="all">Custom</option>
	    </select>
		
		<br/>
		
	    <div id="customSetup">
			<div id="availableRolesWrapper">
				<button class="w3-btn w3-green w3-large" onclick="addSelectedRoles()">Add Roles To Script</button>
				<div id="availableRolesDiv">
					<h2>Available Roles</h2>
				</div>
			</div>
			<div id="selectedRolesWrapper">
				<button class="w3-btn w3-red w3-large" onclick="removeSelectedRoles()">Remove Roles From Script</button>
				<div id="selectedRolesDiv">
					<h2>Selected Roles</h2>
				</div>
			</div>
		</div>
		<button class="w3-btn w3-green w3-xlarge" onclick="saveCustomScript()">Save Script</button>
	</div>
	<script>
		var firstLoad = true;
		function updateTestCentralDiv() 
		{
			let central = document.getElementById('central');
			central.innerHTML = null;
			central.innerHTML += '<label for="playerCountInput">Player count: <span id="playerCountSpanTest">10</span></label>';
			central.innerHTML += '<input id="playerCountInput" type="range" min="5" max="20" step="1" value="10" onchange="setPlayerCountTest(this)"/>';
			central.innerHTML += '<br>';
			//cx
			central.innerHTML += '<label>CX: </label>';
			central.innerHTML += '<input type="number" min="-250" max="250" id="cx" value="200" />';
			//cy
			central.innerHTML += '<label>CY: </label>';
			central.innerHTML += '<input type="number" min="-250" max="250" id="cy" value="200" />';
			central.innerHTML += '<br>';
			//eclipseWidth
			central.innerHTML += '<label>EW: </label>';
			central.innerHTML += '<input type="number" min="100" max="1000" id="ew" value="250" />';
			//eclipseHeight
			central.innerHTML += '<label>EH: </label>';
			central.innerHTML += '<input type="number" min="100" max="1000" id="eh" value="250" />';
			central.innerHTML += '<br>';
			//shortestSideRatio (1.1)
			central.innerHTML += '<label>SSR: </label>';
			central.innerHTML += '<input type="number" min="0" max="10" step="0.1" id="ssr" value="1.1" />';
			//playerCountRatio
			central.innerHTML += '<label>PCR: </label>';
			central.innerHTML += '<input type="number" min="0" max="10" step="0.1" id="pcr" value="0.6" />';
			central.innerHTML += '<br>';
			//minTokenSize
			central.innerHTML += '<label>Token Min: </label>';
			central.innerHTML += '<input type="number" min="0" max="1000" id="tMin" value="50" />';
			//maxTokenSize
			central.innerHTML += '<label>Token Max: </label>';
			central.innerHTML += '<input type="number" min="50" max="1000" id="tMax" value="300" />';
			
			central.innerHTML += '<br><br>';
			central.innerHTML += '<button onclick="testTokenOutput()">Regenerate</button>';
			firstLoad = false;
		}
		function setPlayerCountTest(input)
		{
			playerCount = input.value;
			document.getElementById("playerCountSpanTest").innerHTML = playerCount;
			//init(playerCount);
			setupPlayersArray(playerCount);
			//setup();
			testTokenOutput();
		}
		function checkTest()
		{
			if(!firstLoad) return false;
			updateTestCentralDiv();
			let [w, h, r] = calcScreenDimensions();
			let cx = (0.5 * w);
			document.getElementById('cx').value = cx;
			let cy = (0.5 * h);
			document.getElementById('cy').value = cy;
			let eclipseWidth = w / 3;
			document.getElementById('ew').value = eclipseWidth;
			let eclipseHeight = h / 3;
			document.getElementById('eh').value = eclipseHeight;
		}
		function testTokenOutput()
		{
			let cx = parseInt(document.getElementById('cx').value);
			let cy = parseInt(document.getElementById('cy').value);
			let eclipseHeight = parseInt(document.getElementById('eh').value);
			let eclipseWidth = parseInt(document.getElementById('ew').value);
			let shortestSideRatio = parseFloat(document.getElementById('ssr').value);
			let playerCountRatio = parseFloat(document.getElementById('pcr').value);
			let tMin = parseInt(document.getElementById('tMin').value);
			let tMax = parseInt(document.getElementById('tMax').value);

			console.log('TEST => cx:',cx, 'cy:',cy, 
				'ew:',eclipseWidth, 'eh:',eclipseHeight, 
				'ssr:',shortestSideRatio, 'pcr:',playerCountRatio,
				'tMin:',tMin, 'tMax:',tMax
			);

			testPlayerTokens(cx, cy, eclipseWidth, eclipseHeight, shortestSideRatio, playerCountRatio, tMin, tMax);
		}
	</script>
</body>

</html>